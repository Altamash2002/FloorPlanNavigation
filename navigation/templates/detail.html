{% include "base.html" %}

{% block main %}


<h1 class="text-center my-5">Indoor Navigation App</h1>

<nav class="container">
    <div class="nav nav-pills row justify-content-center" id="nav-tab" role="tablist">
        <button class="nav-link active col-6 col-md-5" id="nav-home-tab" data-bs-toggle="tab" data-bs-target="#nav-home" type="button" role="tab" aria-controls="nav-home" aria-selected="true">Search Teacher</button>
        <button class="nav-link col-6 col-md-5" id="nav-profile-tab" data-bs-toggle="tab" data-bs-target="#nav-profile" type="button" role="tab" aria-controls="nav-profile" aria-selected="false">Search Place Directly</button>
    </div>
</nav>
<div class="tab-content" id="nav-tabContent">
    <div class="tab-pane fade show active" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab" tabindex="0">
        <div class="container mt-5">
            <!-- try -->
            <form action="choose" method="post" class="bg-white p-5 shadow rounded" id="myForm">
                {% csrf_token %}
                <h2 class="mb-4">Details</h2>
            
                <div class="mb-3">
                    <h6 class="mb-3">Department :</h6>
                    <select class='form-select iselect2' name="department" id="departmentSelect">
                        <option value="" selected disabled>Select Department</option>
                        {% for department in departments %}
                            <option value="{{ department.id }}">{{ department.name }}</option>
                        {% endfor %}
                    </select>
                </div>
            
                <div class="mb-3">
                    <h6 class="mb-3">Teacher to Meet :</h6>
                    <select class='form-select iselect2' name="teacher" id="teacherSelect" required>
                        {% for teacher in teachers %}
                            <option value="{{ teacher.id }}" data-department="{{ teacher.department.id }}">{{ teacher }}</option>
                        {% endfor %}
                    </select>
                </div>
            
                <button type="submit" class="btn btn-primary">Submit</button>
            </form>            
        </div>
    </div>
    <div class="tab-pane fade" id="nav-profile" role="tabpanel" aria-labelledby="nav-profile-tab" tabindex="0">
        <div class="container mt-5">
            <form class="bg-white shadow rounded p-5" action="floor-navigate" method='get'>

                <div class="form-group">
                    <h6>From:</h6>
                    <select class='form-control iselect2 my-3' id="from-floor" name="from_floor" required>
                        <option value="" selected disabled>Select Floor</option>
                        {% for floor in floors %}
                        <option value="{{floor.id}}">{{floor}}</option>
                        {% endfor %}
                    </select>
                    <select class='form-control iselect2 my-3' id="from-place" name="from_place" required>
                        <option value="" selected disabled>Select place</option>
                        {% for place in places %}
                        <option value="{{place.title}}">{{place}}</option>
                        {% endfor %}
                    </select>
                </div>
    
                <div class="form-group">
                    <h6>To:</h6>
                    <select class='form-control iselect2 my-3' id="to-floor" name="to_floor" required>
                        <option value="" selected disabled>Select Floor</option>
                        {% for floor in floors %}
                        <option value="{{floor.id}}">{{floor}}</option>
                        {% endfor %}
                    </select>
                    <select class='form-control iselect2 my-3' id="to-place" name="to_place" required>
                        <option value="" selected disabled>Select place</option>
                        {% for place in places %}
                        <option value="{{place.title}}">{{place}}</option>
                        {% endfor %}
                    </select>
                </div>
    
                <input class='btn btn-primary btn2' type="submit" value="Search">
            </form>
        </div>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        // Initial population of the second dropdown
        updateTeacherOptions();
    
        // Event listener for the change in the first dropdown
        document.getElementById("departmentSelect").addEventListener("change", function() {
            updateTeacherOptions();
        });
    
        // Function to update the options of the second dropdown based on the selected department
        function updateTeacherOptions() {
            var selectedDepartment = document.getElementById("departmentSelect").value;
            var teacherSelect = document.getElementById("teacherSelect");
    
            // Clear existing options
            teacherSelect.innerHTML = '';
    
            // Add default option
            var defaultOption = document.createElement('option');
            defaultOption.value = '';
            defaultOption.text = 'Select Teacher';
            teacherSelect.appendChild(defaultOption);
    
            // Add options based on the selected department
            {% for teacher in teachers %}
                if ("{{ teacher.department.id }}" === selectedDepartment || selectedDepartment === "") {
                    var option = document.createElement('option');
                    option.value = "{{ teacher.id }}";
                    option.innerHTML = "{{ teacher.name }}";
                    teacherSelect.appendChild(option);
                }
            {% endfor %}
        }
    });
</script>    

{% endblock  %}